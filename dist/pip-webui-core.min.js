!function(){"use strict";angular.module("pipCore",["pipUtils","pipErrors","pipTransactions","pipTranslate","pipState","pipTimer","pipAssert","pipDebug","pipTranslateFilters","pipClearErrors","pipFocused","pipSelected","pipInfiniteScroll","pipDraggable","pipUnsavedChanges","pipFabTooltipVisibility"])}(),function(){"use strict";var e=angular.module("pipClearErrors",[]);e.directive("pipClearErrors",function(){return{restrict:"A",require:["ngModel","^?form"],link:function(e,t,n,r){function i(){var e=o.$error;for(var t in e)e.hasOwnProperty(t)&&"ERROR_"==t.substring(0,6)&&o.$setValidity(t,!0)}function a(){s.$serverError={}}var o=r[0],s=r[1];e.$watch(n.ngModel,function(e){i(),a()})}}})}(),function(){"use strict";var e=angular.module("pipDraggable",["pipUtils"]);e.service("pipDraggable",function(){var e=this;e.inputEvent=function(e){return angular.isDefined(e.touches)?e.touches[0]:angular.isDefined(e.originalEvent)&&angular.isDefined(e.originalEvent.touches)?e.originalEvent.touches[0]:e}}),e.directive("pipDrag",["$rootScope","$parse","$document","$window","pipDraggable","pipUtils",function(e,t,n,r,i,a){return{restrict:"A",link:function(o,s,l){function u(){R.left=s.css("css"),R.top=s.css("top"),R.position=s.css("position"),R.width=s.css("width")}o.value=l.ngDrag;var c,p,f,d,g,h,v,m,b=50,$=!1,S="ontouchstart"in window||window.DocumentTouch&&document instanceof DocumentTouch,E="touchstart mousedown",w="touchmove mousemove",y="touchend mouseup",T=o.$id,_=null,C=null,D=!1,O=null,R={},k=t(l.pipDragStart)||null,A=t(l.pipDragStop)||null,x=t(l.pipDragSuccess)||null,N=!!angular.isDefined(l.allowTransform)&&o.$eval(l.allowTransform),I=t(l.pipDragData),U=a.toBoolean(l.pipVerticalScroll)||!0,B=a.toBoolean(l.pipHorizontalScroll)||!0,P=parseFloat(l.pipActivationDistance)||75,F=parseFloat(l.pipScrollDistance)||50,j=!1,L=angular.element(window),W=t(l.pipScrollContainer),Y=angular.noop,q=function(){if(s.attr("pip-draggable","false"),s[0].querySelectorAll)var e=angular.element(s[0].querySelectorAll("[pip-drag-handle]"));else var e=s.find("[pip-drag-handle]");e.length&&(m=e),H(!0),L=j?angular.element($element.parent()):l.pipScrollContainer?angular.element(W(o)):angular.element(window)},H=function(e){e&&(o.$on("$destroy",M),o.$watch(l.pipDrag,G),o.$watch(l.pipCenterAnchor,K),m?m.on(E,z):s.on(E,z),S||"img"!=s[0].nodeName.toLowerCase()||s.on("mousedown",function(){return!1}))},M=function(e){H(!1)},G=function(e,t){D=e},K=function(e,t){angular.isDefined(e)&&($=e||"true")},V=function(e){return angular.isDefined(angular.element(e.target).attr("pip-cancel-drag"))},z=function(e){D&&(V(e)||"mousedown"==e.type&&0!=e.button||(u(),S?(X(),O=setTimeout(function(){X(),J(e)},b),n.on(w,X),n.on(y,X)):J(e)))},X=function(){clearTimeout(O),n.off(w,X),n.off(y,X)},J=function(t){D&&(t.preventDefault(),c=s[0].getBoundingClientRect(),C=N?c:{left:document.body.scrollLeft,top:document.body.scrollTop},s.centerX=s[0].offsetWidth/2,s.centerY=s[0].offsetHeight/2,p=i.inputEvent(t).pageX,f=i.inputEvent(t).pageY,h=p-c.left,v=f-c.top,$?(d=p-s.centerX-r.pageXOffset,g=f-s.centerY-r.pageYOffset):(d=p-h-r.pageXOffset,g=f-v-r.pageYOffset),n.on(w,Q),n.on(y,Z),Y=e.$on("draggable:_triggerHandlerMove",function(e,t){Q(t)}))},Q=function(t){D&&(t.preventDefault(),s.hasClass("pip-dragging")||(_=I(o),s.addClass("pip-dragging"),e.$broadcast("draggable:start",{x:p,y:f,tx:d,ty:g,event:t,element:s,data:_}),k&&o.$apply(function(){k(o,{$data:_,$event:t})})),p=i.inputEvent(t).pageX,f=i.inputEvent(t).pageY,(B||U)&&re(),$?(d=p-s.centerX-C.left,g=f-s.centerY-C.top):(d=p-h-C.left,g=f-v-C.top),ne(d,g),e.$broadcast("draggable:move",{x:p,y:f,tx:d,ty:g,event:t,element:s,data:_,uid:T,dragOffset:C}))},Z=function(t){D&&(t.preventDefault(),e.$broadcast("draggable:end",{x:p,y:f,tx:d,ty:g,event:t,element:s,data:_,callback:ee,uid:T}),s.removeClass("pip-dragging"),s.parent().find(".pip-drag-enter").removeClass("pip-drag-enter"),te(),n.off(w,Q),n.off(y,Z),A&&o.$apply(function(){A(o,{$data:_,$event:t})}),Y())},ee=function(e){x&&o.$apply(function(){x(o,{$data:_,$event:e})})},te=function(){N?s.css({transform:"","z-index":"","-webkit-transform":"","-ms-transform":""}):s.css({position:R.position,top:R.top,left:R.left,"z-index":"",width:R.width})},ne=function(e,t){var n=s.css("width");N?s.css({transform:"matrix3d(1, 0, 0, 0, 0, 1, 0, 0, 0, 0, 1, 0, "+e+", "+t+", 0, 1)","z-index":99999,"-webkit-transform":"matrix3d(1, 0, 0, 0, 0, 1, 0, 0, 0, 0, 1, 0, "+e+", "+t+", 0, 1)","-ms-transform":"matrix(1, 0, 0, 1, "+e+", "+t+")"}):s.css({left:e+"px",top:t+"px",position:"fixed","z-index":100,width:n})},re=function(){var e=0,t=0,n=function(e){return e.offset()||{left:0,top:0}};if(B){var r=n(L).left,i=L.innerWidth(),a=r+i;p-r<P?e=-F:a-p<P&&(e=F)}if(U){var o=n(L).top,s=L.innerHeight(),l=o+s;f-o<P?t=-F+30:l-f<P&&(t=F-30)}if(0!==e||0!==t){var u=L.scrollLeft(),c=L.scrollTop();L.scrollLeft(u+e),L.scrollTop(c+t)}};q()}}}]),e.directive("pipDrop",["$parse","$timeout","$window","$document","pipDraggable",function(e,t,n,r,i){return{restrict:"A",link:function(n,i,a){n.value=a.pipDrop,n.isTouching=!1;var o=null,s=n.$id,l=!1,u=e(a.pipDropSuccess),c=e(a.pipDragStart),p=e(a.pipDragStop),f=e(a.pipDragMove),d=function(){g(!0)},g=function(e){e&&(n.$watch(a.pipDrop,v),n.$on("$destroy",h),n.$on("draggable:start",m),n.$on("draggable:move",b),n.$on("draggable:end",$))},h=function(e){g(!1)},v=function(e,t){l=e},m=function(e,r){l&&(S(r.x,r.y,r.element),a.pipDragStart&&t(function(){c(n,{$data:r.data,$event:r})}))},b=function(e,r){l&&(S(r.x,r.y,r.element),a.pipDragMove&&t(function(){f(n,{$data:r.data,$event:r})}))},$=function(e,r){return l&&s!==r.uid?(S(r.x,r.y,r.element)&&(r.callback&&r.callback(r),a.pipDropSuccess&&t(function(){u(n,{$data:r.data,$event:r,$target:n.$eval(n.value)})})),a.pipDragStop&&t(function(){p(n,{$data:r.data,$event:r})}),void E(!1,r.element)):void E(!1,r.element)},S=function(e,t,r){var a=w(e,t);return n.isTouching=a,a&&(o=i),E(a,r),a},E=function(e,t){e?(i.addClass("pip-drag-enter"),t.addClass("pip-drag-over")):o==i&&(o=null,i.removeClass("pip-drag-enter"),t.removeClass("pip-drag-over"))},w=function(e,t){var n=i[0].getBoundingClientRect();return e-=r[0].body.scrollLeft+r[0].documentElement.scrollLeft,t-=r[0].body.scrollTop+r[0].documentElement.scrollTop,e>=n.left&&e<=n.right&&t<=n.bottom&&t>=n.top};d()}}}]),e.directive("pipPreventDrag",["$parse","$timeout",function(e,t){return{restrict:"A",link:function(e,t,n){var r=function(){t.attr("pip-draggable","false"),i(!0)},i=function(e){e&&t.on("mousedown touchstart touchmove touchend touchcancel",a)},a=function(e){var t=e.originalEvent;return t.preventDefault&&t.preventDefault(),t.stopPropagation&&t.stopPropagation(),t.cancelBubble=!0,t.returnValue=!1,!1};r()}}}]),e.directive("pipCancelDrag",function(){return{restrict:"A",link:function(e,t,n){t.find("*").attr("pip-cancel-drag","pip-cancel-drag")}}})}(),function(){"use strict";var e=angular.module("pipFabTooltipVisibility",[]);e.directive("pipFabTooltipVisibility",["$parse","$timeout",function(e,t){return{restrict:"A",scope:!1,controller:["$scope","$attrs",function(n,r){var i=e(r.pipFabTooltipVisibility),a=e(r.pipFabShowTooltip),o=a.assign;n.$watch(i,function(e){e?t(function(){o(n,e)},600):o(n,e)})}]}}])}(),function(){"use strict";var e=angular.module("pipFocused",[]);e.directive("pipFocused",["$timeout","$mdConstant",function(e,t){return{require:"?ngModel",link:function(n,r,i){function a(){var e=u?".pip-focusable":".pip-focusable:visible";s=r.find(e),l=s.length,s.on("focus",function(){r.addClass("pip-focused-container"),$(this).addClass("md-focused")}).on("focusout",function(){r.removeClass("pip-focused-container")})}function o(e){var n=e.which||e.keyCode;if(n==t.KEY_CODE.LEFT_ARROW||n==t.KEY_CODE.UP_ARROW||n==t.KEY_CODE.RIGHT_ARROW||n==t.KEY_CODE.DOWN_ARROW){e.preventDefault();var r=n==t.KEY_CODE.RIGHT_ARROW||n==t.KEY_CODE.DOWN_ARROW?1:-1,i=s.index(s.filter(".md-focused"))+r;i>=0&&i<l&&s[i].focus()}}var s,l,u=i.pipWithHidden;e(a),r.on("keydown",o),n.$watch(i.ngModel,function(){e(a)},!0)}}}])}(),function(){"use strict";var e=angular.module("pipInfiniteScroll",[]);e.directive("pipInfiniteScroll",["$rootScope","$window","$interval","$parse",function(e,t,n,r){var i=500;return{scope:{pipInfiniteScroll:"&",pipScrollContainer:"=",pipScrollDistance:"=",pipScrollDisabled:"=",pipScrollUseDocumentBottom:"=",pipScrollListenForEvent:"@"},link:function(r,a,o){function s(e){return e=e[0]||e,isNaN(e.offsetHeight)?e.document.documentElement.clientHeight:e.offsetHeight}function l(e){if(e[0].getBoundingClientRect&&!e.css("none"))return e[0].getBoundingClientRect().top+u(e)}function u(e){return e=e[0]||e,isNaN(window.pageYOffset)?e.document.documentElement.scrollTop:e.ownerDocument.defaultView.pageYOffset}function c(e){return b=parseFloat(e)||0}function p(e){if($=!e,$&&v)return v=!1,y()}function f(e){return E=e}function d(e){if(null!=h&&h.unbind("scroll",y),h=e,null!=e)return h.bind("scroll",y)}function g(e){if(null!=e&&0!==e.length){if(e instanceof HTMLElement?e=angular.element(e):"function"==typeof e.append?e=angular.element(e[e.length-1]):"string"==typeof e&&(e=a.parents().find(e)),null!=e&&(!Array.isArray(e)||Array.isArray(e)&&e.length>0))return d(e);throw new Error("Invalid pip-scroll-container attribute.")}}var h,v=null,m=!0,b=null,$=null,S=null,E=!1,w=angular.element(t),y=function(){var t,n,i,o,c;return h===w?(t=s(h)+u(h[0].document.documentElement),i=l(a)+s(a)):(t=s(h),n=0,void 0!==l(h)&&(n=l(h)),i=l(a)-n+s(a)),E&&(i=s((a[0].ownerDocument||a[0].document).documentElement)),o=i-t,c=o<=s(h)*b+1,c?(v=!0,$?r.$$phase||e.$$phase?r.pipInfiniteScroll():r.$apply(r.pipInfiniteScroll):void 0):v=!1};return null!=i&&(y=_.throttle(y,i)),r.$on("$destroy",function(){if(h.unbind("scroll",y),null!=S)return S(),S=null}),r.$watch("pipScrollDistance",c),c(r.pipScrollDistance),r.$watch("pipScrollDisabled",p),p(r.pipScrollDisabled),r.$watch("pipScrollUseDocumentBottom",f),f(r.pipScrollUseDocumentBottom),d(w),r.pipScrollListenForEvent&&(S=e.$on(r.pipScrollListenForEvent,y)),r.$watch("pipScrollContainer",function(e){e!==h&&g(e)}),g(r.pipScrollContainer||[]),null!=o.pipScrollParent&&d(angular.element(a.parent())),null!=o.pipScrolImmediateCheck&&(m=r.$eval(o.pipScrolImmediateCheck)),n(function(){if(m)return y()},0,1)}}}])}(),function(){"use strict";var e=angular.module("pipSelected",["pipUtils"]);e.directive("pipSelected",["$parse","pipUtils","$mdConstant","$timeout",function(e,t,n,r){return{restrict:"A",scope:!1,link:function(r,i,a){function o(e){var t=e.itemIndex,n=e.itemId,r=e.items||i.find(m+v),a=r.length,o=function(){return e.item?e.item:(void 0===t&&t===-1&&(t=r.index(r.filter("[pip-id="+n+"]"))),t>=0&&t<a?r[t]:void 0)}(),u=e.raiseEvent;o&&(i.find(m).removeClass("selected md-focused"),o=angular.element(o).addClass("selected md-focused").focus(),h||l(o),u&&s(r))}function s(e){function t(){var t=angular.element(e[b]),a=t.attr("pip-id");c&&c(r,b),f&&f(r,a),d&&d(r,{$event:{target:i,item:t,index:b,id:a,newIndex:b,oldIndex:n}})}var n=b;b=-1;for(var a=0;a<e.length;a++)if($(e[a]).hasClass("selected")){b=a;break}n!=b&&b!==-1&&r.$apply(t)}function l(e){if(!h){var t=i.offset().top,n=i.height(),r=t+n,a=e.offset().top,o=e.outerHeight(!0),s=a+o,l=i.scrollTop();t>a?i.scrollTop(l+a-t):r<s&&i.scrollTop(l+s-r)}}var u=a.pipSelected?e(a.pipSelected):null,c=u?u.assign:null,p=a.pipSelectedId?e(a.pipSelectedId):null,f=p?p.assign:null,d=a.pipSelect?e(a.pipSelect):null,g=a.pipEnterSpacePress?e(a.pipEnterSpacePress):null,h=t.toBoolean(a.pipNoScroll),v=t.toBoolean(a.pipSkipHidden)?":visible":"",m=t.toBoolean(a.pipTreeList)?".pip-selectable-tree":".pip-selectable",b=u(r),S=i.attr("tabindex"),E=a.pipSelectedWatch;i.attr("tabindex",S||0),t.toBoolean(a.pipTreeList)?r.$watch(p,function(e){setTimeout(function(){o({itemId:e,raiseEvent:!0})},0)}):r.$watch(u,function(e){o({itemIndex:e})}),E&&r.$watch(E,function(){setTimeout(function(){b=u(r),o({itemIndex:b})},100)}),o({itemIndex:b,items:i.find(m)}),i.on("click touchstart",m,function(e){o({item:e.currentTarget,raiseEvent:!0})}),i.on("keydown",function(e){var t=e.which||e.keyCode;if(t==n.KEY_CODE.ENTER||t==n.KEY_CODE.SPACE)e.preventDefault(),e.stopPropagation(),g&&g(r,{$event:{target:i,index:b,item:i.find(".selected")}});else if(t==n.KEY_CODE.LEFT_ARROW||t==n.KEY_CODE.RIGHT_ARROW||t==n.KEY_CODE.UP_ARROW||t==n.KEY_CODE.DOWN_ARROW){e.preventDefault(),e.stopPropagation();var a=i.find(m+v),s=t==n.KEY_CODE.RIGHT_ARROW||t==n.KEY_CODE.DOWN_ARROW?1:-1,l=b+s;o({itemIndex:l,items:a,raiseEvent:!0})}}),i.on("focusin",function(e){var t,n=i.find(m+".selected");n.addClass("md-focused"),0===n.length&&(b=u(r),t=i.find(m+v),o({itemIndex:b||0,items:t,raiseEvent:!0}))}),i.on("focusout",function(e){i.find(m+".md-focused"+v).removeClass("md-focused")})}}}])}(),function(){"use strict";var e=angular.module("pipUnsavedChanges",[]);e.directive("pipUnsavedChanges",["$window","$rootScope",function(e,t){return{restrict:"AE",scope:{unsavedChangesAvailable:"&pipUnsavedChangesAvailable",unsavedChangesMessage:"@pipUnsavedChangesMessage",afterLeave:"&pipUnsavedChangesAfterLeave"},link:function(n){e.onbeforeunload=function(){if(n.unsavedChangesAvailable())return t.$routing=!1,n.unsavedChangesMessage};var r=n.$on("$stateChangeStart",function(r){n.unsavedChangesAvailable()&&!e.confirm(n.unsavedChangesMessage)?(t.$routing=!1,r.preventDefault()):_.isFunction(n.afterLeave)&&n.afterLeave()});n.$on("$destroy",function(){e.onbeforeunload=null,r()})}}}])}(),function(){"use strict";var e=angular.module("pipTranslateFilters",["pipTranslate"]);e.filter("translate",["pipTranslate",function(e){return function(t){return e.translate(t)||t}}])}(),function(){"use strict";var e=angular.module("pipUtils.Collections",[]);e.factory("pipCollections",function(){var e={};return e.indexBy=function(e,t,n){if(!e||!e.length)return null;for(var r=0;r<e.length;r++)if(e[r][t]==n)return r;return null},e.findBy=function(e,t,n){if(!e||!e.length)return null;for(var r=0;r<e.length;r++)if(e[r][t]==n)return e[r];return null},e.remove=function(e,t){if(!e||!e.length)return null;for(var n=0;n<e.length;n++)e[n]==t&&(e.splice(n,1),n--)},e.removeBy=function(e,t,n){if(!e||!e.length)return null;for(var r=0;r<e.length;r++)e[r][t]==n&&(e.splice(r,1),r--)},e.replaceBy=function(e,t,n,r){if(!e||!e.length)return null;for(var i=0;i<e.length;i++)if(e[i][t]==n)return void(e[i]=r)},e.difference=function(e,t,n){var r=[];return _.each(e,function(e){var i=_.find(t,function(t){return n(e,t)});null==i&&r.push(e)}),r},e})}(),function(){"use strict";var e=angular.module("pipUtils.FormErrors",[]);e.factory("pipFormErrors",["$rootScope",function(e){function t(e){if(null!=e)return _.isEmpty(e.$error)?{hint:!0}:e.$error}function n(e,t){if(null!=e&&null!=t){if(e.$submitted&&(t.$touched||e.$dirty)||!e.$submitted&&(t.$touched||t.$dirty)){var n=_.isEmpty(t.$error)?{hint:!0}:t.$error;return n}return{hint:!0}}}function r(e,t){e.$setPristine(),e.$setUntouched(),t&&(e.$setDirty(),e.$setSubmitted()),e.$serverError={}}function i(e,t){if(e)if(t&&e[t]&&e[t].$error)e[t].$error={};else{for(var n in e)e[n]&&e[n].$error&&(e[n].$error={});e&&e.$error&&(e.$error={})}}function a(e,t,n){if(null!=t){e.$serverError=e.$serverError||{};var r=t.code||(t.data||{}).code||null;if(!r&&t.status&&(r=t.status),r){var i="ERROR_"+r,a=n?n[r]:null;if(a&&e[a]&&e[a].$setValidity)return void e[a].$setValidity(i,!1);if("form"==a)return void(e.$serverError[i]=!0)}if(t.data&&t.data.message)return e.$serverError.ERROR_UNKNOWN=t.data.message,void o(t);if(t.message)return e.$serverError.ERROR_UNKNOWN=t.message,void o(t);if(t.name)return e.$serverError.ERROR_UNKNOWN=t.name,void o(t);e.$serverError.ERROR_UNKNOWN=t,o(t)}}function o(t){e.$emit("pipUnhandledInternalError",{error:t})}return{errorsWithHint:t,touchedErrorsWithHint:n,resetFormErrors:r,setFormError:a,resetFieldsErrors:i}}])}(),function(){"use strict";var e=angular.module("pipUtils.General",["pipState","pipAssert"]);e.factory("pipUtils",["$rootScope","$window","$state","pipAssert",function(e,t,n,r){function i(e,t){if(t<1)return"";for(var n="";t>0;)1&t&&(n+=e),t>>=1,e+=e;return n}function a(e,t,n,r){if(!e||!e.length)return null;for(var i=0;i<e.length;i++)if(e[i][t]==n)return void(e[i]=r)}function o(e,t){if(!e||""==e)return"";var n=e.indexOf("\n");return n=n>=0?n:e.length,n=n<t?e.length:t,e.substring(0,n)}function s(e){if(null==e)return 0;for(var t=0,n=0;n<e.length;n++)t+=e.charCodeAt(n);return t}function l(e){return null==e?"":""+e}function c(e){var t=new RegExp("^[0-9a-fA-F]{24}$");return t.test(e)}function p(e,t){return null==e&&null==t||null!=e&&null!=t&&e.toString()==t.toString()}function f(e,t){return(null!=e||null!=t)&&(null==e||null==t||e.toString()!=t.toString())}function d(e,t){return _.some(e,function(e){return p(e,t)})}function g(e,t,n,r){return _.isObject(t)&&"undefined"==typeof r&&(r=n,n=t,t=r),!!(n[r]||"number"==typeof n[r]&&n[r]%1==0)&&(e[t]=n[r],!0)}function h(e,t,n){var r=e[t],i=e[n];r?e[n]=r:delete e[n],i?e[t]=i:delete e[t]}function v(e){return null!=e&&(!!e&&(e=e.toString().toLowerCase(),"1"==e||"true"==e))}function m(e){return _.map(e,function(e){return e?e.toString():0})}function b(){return Math.random().toString(36).substr(2,10).toUpperCase()}function S(){t.history.back()}function E(i,a,o){if(r.isDef(i,"pipUtils.goBack: first argument should be defined"),r.isDef(a,"pipUtils.goBack: second argument should be defined"),r.isDef(o,"pipUtils.goBack: third argument should be defined"),r.isObject(i,"pipUtils.goBack: first argument should be an object"),r.isString(a,"pipUtils.goBack: second argument should a string"),r.isString(o,"pipUtils.goBack: third argument should a string"),e.$prevState&&e.$prevState.name){var s=_.cloneDeep(e.$prevState);s.params[a]=i.id,s.params[o]=i,n.go(s.name,s.params)}else t.history.back()}function w(e,t,n){e&&t&&(void 0==n&&(n=300),setTimeout(function(){if($(t).position()){var r=Math.abs($(e).scrollTop()-$(t).position().top);if(!(r<20)){var i=$(e).scrollTop()+($(t).position().top-20);n>0&&$(e).animate({scrollTop:i+"px"},n)}}},100))}function y(){var e,n=t.navigator.userAgent,r=function(){return n.search(/Edge/)>-1?"edge":n.search(/MSIE/)>-1?"ie":n.search(/Trident/)>-1?"ie11":n.search(/Firefox/)>-1?"firefox":n.search(/Opera/)>-1?"opera":n.search(/OPR/)>-1?"operaWebkit":n.search(/YaBrowser/)>-1?"yabrowser":n.search(/Chrome/)>-1?"chrome":n.search(/Safari/)>-1?"safari":n.search(/Maxthon/)>-1?"maxthon":void 0}();switch(r){case"edge":e=n.split("Edge")[1].split("/")[1];break;case"ie":e=n.split("MSIE ")[1].split(";")[0];break;case"ie11":r="ie",e=n.split("; rv:")[1].split(")")[0];break;case"firefox":e=n.split("Firefox/")[1];break;case"opera":e=n.split("Version/")[1];break;case"operaWebkit":r="opera",e=n.split("OPR/")[1];break;case"yabrowser":e=n.split("YaBrowser/")[1].split(" ")[0];break;case"chrome":e=n.split("Chrome/")[1].split(" ")[0];break;case"safari":e=n.split("Version/")[1].split(" ")[0];break;case"maxthon":e=n.split("Maxthon/")[1]}var i="desktop";/iphone|ipad|ipod|android|blackberry|mini|windows\sce|palm/i.test(n.toLowerCase())&&(i="mobile");var a;try{var o=(/(windows|mac|android|linux|blackberry|sunos|solaris|iphone)/.exec(n.toLowerCase())||[u])[0].replace("sunos","solaris"),s=/(android)/.exec(n.toLowerCase())||"";a=!s||"android"!=s&&"android"!=s[0]?o:"android"}catch(e){a="unknown"}var l;try{l={platform:i,browser:r,versionFull:e,versionShort:e.split(".")[0],os:a}}catch(e){l={platform:i,browser:"unknown",versionFull:"unknown",versionShort:"unknown",os:"unknown"}}return l}function T(e){e||(e={edge:11,ie:11,firefox:43,opera:35,chrome:47});var t=y();return t&&t.browser&&e[t.browser]&&t.versionShort>=e[t.browser],!0}var C=Object.prototype.toString,D=function e(){function t(e){return C.call(e).slice(8,-1).toLowerCase()}var n=i,r=function(){return r.cache.hasOwnProperty(arguments[0])||(r.cache[arguments[0]]=r.parse(arguments[0])),r.format.call(null,r.cache[arguments[0]],arguments)};return r.format=function(r,i){var a,o,s,l,u,c,p,f=1,d=r.length,g="",h=[];for(o=0;o<d;o++)if(g=t(r[o]),"string"===g)h.push(r[o]);else if("array"===g){if(l=r[o],l[2])for(a=i[f],s=0;s<l[2].length;s++){if(!a.hasOwnProperty(l[2][s]))throw new Error(e('[_.sprintf] property "%s" does not exist',l[2][s]));a=a[l[2][s]]}else a=l[1]?i[l[1]]:i[f++];if(/[^s]/.test(l[8])&&"number"!=t(a))throw new Error(e("[_.sprintf] expecting number but found %s",t(a)));switch(l[8]){case"b":a=a.toString(2);break;case"c":a=String.fromCharCode(a);break;case"d":a=parseInt(a,10);break;case"e":a=l[7]?a.toExponential(l[7]):a.toExponential();break;case"f":a=l[7]?parseFloat(a).toFixed(l[7]):parseFloat(a);break;case"o":a=a.toString(8);break;case"s":a=(a=String(a))&&l[7]?a.substring(0,l[7]):a;break;case"u":a=Math.abs(a);break;case"x":a=a.toString(16);break;case"X":a=a.toString(16).toUpperCase()}a=/[def]/.test(l[8])&&l[3]&&a>=0?"+"+a:a,c=l[4]?"0"==l[4]?"0":l[4].charAt(1):" ",p=l[6]-String(a).length,u=l[6]?n(c,p):"",h.push(l[5]?a+u:u+a)}return h.join("")},r.cache={},r.parse=function(e){for(var t=e,n=[],r=[],i=0;t;){if(null!==(n=/^[^\x25]+/.exec(t)))r.push(n[0]);else if(null!==(n=/^\x25{2}/.exec(t)))r.push("%");else{if(null===(n=/^\x25(?:([1-9]\d*)\$|\(([^\)]+)\))?(\+)?(0|'[^$])?(-)?(\d+)?(?:\.(\d+))?([b-fosuxX])/.exec(t)))throw new Error("[_.sprintf] huh?");if(n[2]){i|=1;var a=[],o=n[2],s=[];if(null===(s=/^([a-z_][a-z_\d]*)/i.exec(o)))throw new Error("[_.sprintf] huh?");for(a.push(s[1]);""!==(o=o.substring(s[0].length));)if(null!==(s=/^\.([a-z_][a-z_\d]*)/i.exec(o)))a.push(s[1]);else{if(null===(s=/^\[(\d+)\]/.exec(o)))throw new Error("[_.sprintf] huh?");a.push(s[1])}n[2]=a}else i|=2;if(3===i)throw new Error("[_.sprintf] mixing positional and named placeholders is not (yet) supported");r.push(n)}t=t.substring(n[0].length)}return r},r}();return{copyProperty:g,copy:g,swapProperties:h,swap:h,convertToBoolean:v,toBoolean:v,toBool:v,convertObjectIdsToString:m,OidToString:m,generateVerificationCode:b,vercode:b,goBack:S,goBackAndSelect:E,scrollTo:w,equalObjectIds:p,eqOid:p,notEqualObjectIds:f,neqOid:f,containsObjectId:d,hasOid:d,isObjectId:c,sampleLine:o,hashCode:s,makeString:l,getBrowser:y,checkSupported:T,sprintf:D,replaceBy:a}}])}(),function(){"use strict";var e=angular.module("pipUtils.Strings",[]);e.factory("pipStrings",function(){var e={};return e.sampleLine=function(e,t){if(!e||""==e)return"";var n=e.indexOf("\n");return n=n>=0?n:e.length,n=n<t?e.length:t,e.substring(0,n)},e.hashCode=function(e){if(null==e)return 0;for(var t=0,n=0;n<e.length;n++)t+=e.charCodeAt(n);return t},e})}(),function(){"use strict";var e=angular.module("pipUtils.Tags",[]);e.factory("pipTags",function(){var e={},t=/#\w+/g,n=function(e){return e?_.trim(e.replace(/(_|#)+/g," ")):null};e.normalizeTag=n;var r=function(e){return e?e.replace(/( |_|#)/g,"").toLowerCase():null};e.compressTag=r;var i=function(e,t){return null==e&&null==t||null!=e&&null!=t&&r(e)==r(t)};e.equalTags=i;var a=function(e){return _.isString(e)&&(e=e.split(/( |,|;)+/)),e=_.map(e,function(e){return n(e)})};e.normalizeTags=a;var o=function(e){return _.isString(e)&&(e=e.split(/( |,|;)+/)),e=_.map(e,function(e){return r(e)})};e.compressTags=o;var s=function(e,n){var r=a(e.tags);return _.each(n,function(n){var i=e[n]||"";if(""!=i){var o=i.match(t);r=r.concat(a(o))}}),_.uniq(r)};return e.extractTags=s,e})}(),function(){"use strict";angular.module("pipUtils",["pipUtils.General","pipUtils.Strings","pipUtils.Tags","pipUtils.Collections","pipUtils.FormErrors"])}(),function(){"use strict";var e=angular.module("pipAssert",["pipDebug"]);e.provider("pipAssert",["pipDebugProvider",function(e){function t(){}function n(e){return Object.prototype.toString.call(e)}function r(e,t){if(!Array.isArray(e))throw new Error(t||e+" should be array")}function i(e,t){if("boolean"!=typeof e)throw new Error(t||e+" should be boolean")}function a(e,t){if(null===e)throw new Error(t||e+" should be not null")}function o(e,t){if("number"!=typeof e)throw new Error(t||e+" should be number")}function s(e,t){if("string"!=typeof e)throw new Error(t||e+" should be string")}function l(e,t){if("object"!=typeof e)throw new Error(t||e+" should be an object")}function u(e,t){if("object"==typeof e&&"[object Date]"!==n(e))throw new Error(t||e+" should be a date")}function c(e,t){if("object"==typeof e&&("[object Error]"!==n(e)||e instanceof Error))throw new Error(t||e+" should be an error")}function p(e,t){if("function"!=typeof e)throw new Error(t||e+" should be a function")}function f(e,t){if("undefined"==typeof e)throw new Error(t||e+" should be defined")}function d(e,t){if(null===e||void 0===e||e===!1)throw new Error(t||e+" should be not null or undefined or false")}function g(e,t,n){if("object"!=typeof e)throw new Error(e+" should be an object");if(null===e[t]||void 0===e[t])throw new Error(n||t+" should be in object "+e)}function h(e,t,n){if(e!=t)throw new Error(n||e+" should be not equal "+t)}function v(e,t,n){if(e==t)throw new Error(n||e+" should be equal "+t)}function m(e,t,n){if(e!==t)throw new Error(n||e+" should not be strict equal "+t)}function b(e,t,n){if(e===t)throw new Error(n||e+" should not strict equal "+t)}function $(e,t){var n=new RegExp("^[0-9a-fA-F]{24}$");if(!n.test(e))throw new Error(t||e+" should be an object id")}return{isEmpty:e.enabled()?d:t,isObjectId:e.enabled()?$:t,isDefined:e.enabled()?f:t,isDef:e.enabled()?f:t,contains:e.enabled()?g:t,equal:e.enabled()?h:t,notEqual:e.enabled()?v:t,strictEqual:e.enabled()?m:t,notStrictEqual:e.enabled()?b:t,isArray:e.enabled()?r:t,isBoolean:e.enabled()?i:t,isNumber:e.enabled()?o:t,isString:e.enabled()?s:t,isObject:e.enabled()?l:t,isDate:e.enabled()?u:t,isError:e.enabled()?c:t,isFunction:e.enabled()?p:t,isNotNull:e.enabled()?a:t,$get:["pipDebug",function(e){return{isEmpty:e.enabled()?d:t,isObjectId:e.enabled()?$:t,isDefined:e.enabled()?f:t,isDef:e.enabled()?f:t,contains:e.enabled()?g:t,equal:e.enabled()?h:t,notEqual:e.enabled()?v:t,strictEqual:e.enabled()?m:t,notStrictEqual:e.enabled()?b:t,isArray:e.enabled()?r:t,isBoolean:e.enabled()?i:t,isNumber:e.enabled()?o:t,isString:e.enabled()?s:t,isObject:e.enabled()?l:t,isDate:e.enabled()?u:t,isError:e.enabled()?c:t,isFunction:e.enabled()?p:t,isNotNull:e.enabled()?a:t}}]}}])}(),function(){"use strict";var e=angular.module("pipDebug",[]);e.provider("pipDebug",["$logProvider",function(e){function t(){return this.enabled}function n(){this.enabled=!0,e.debugEnabled(!0)}function r(){this.enabled=!1,e.debugEnabled(!1)}return this.enabled=!0,{enable:n,disable:r,enabled:t,$get:["$log",function(e){return{enabled:t,log:e.log,info:e.info,warn:e.warn,error:e.error,debug:e.debug}}]}}])}(),function(){"use strict";var e=angular.module("pipErrors",["pipUtils","pipAssert"]);e.factory("pipError",["$rootScope","pipAssert",function(e,t){function n(t){e.errors[t]={message:void 0,code:void 0,details:void 0}}function r(e){if(_.isNull(e))return null;if(e.message)return e.message;if(e.data){if(e.data.code)return"ERROR_"+e.data.code;if(e.data.message)return e.data.message}return e.statusText?e.statusText:e.status?"ERROR_"+e.status:e.data?e.data:e}function i(e){return _.isNull(e)?null:e.data&&e.data.code?e.data.code:e.status?e.status:null}function a(e){return e&&e.data?e.data:e}function o(o,s){o=o||"global";var l={reset:function(){n(o)},empty:function(){var t=e.errors[o];return _.isNull(t)||_.isNull(t.message)&&_.isNull(t.code)},get:function(){return e.errors[o]?e.errors[o]:""},message:function(){return e.errors[o]?e.errors[o].message:null},code:function(){return e.errors[o]?e.errors[o].code:null},details:function(){return e.errors[o]?e.errors[o].details:null},set:function(s){s?(t.isObject(s,"Setting error: error should be an object"),e.errors[o]={message:r(s),code:i(s),details:a(s)},console.error(e.errors[o])):n(o)}};return _.isObject(s)&&(s.error=l),l}return e.errors={},o}])}(),function(){"use strict";var e=angular.module("pipState",["ui.router","pipTranslate","pipAssert"]);e.config(["$locationProvider","$httpProvider","pipTranslateProvider",function(e,t,n){n.translations("en",{ERROR_SWITCHING:"Error while switching route. Try again."}),n.translations("ru",{ERROR_SWITCHING:"Ошибка при переходе. Попробуйте ещё раз."})}]),e.run(["$rootScope","pipTranslate","$state",function(e,t,n){e.$on("$stateChangeSuccess",function(t,r,i,a,o){if(e.$user&&e.$user.id&&r.params&&r.params.access&&i&&i.party_id){var s=_.find(e.$user.party_access,{party_id:i.party_id});if(s){if(("manager"==r.params.access&&!s.manager||"contributor"==r.params.access&&!s.contributor)&&r.params.toState)return t.preventDefault(),void n.go(r.params.toState,i)}else if(i.party_id!=e.$user.id&&r.params.toState)return t.preventDefault(),void n.go(r.params.toState,i)}e.$routing=!1,e.$state={name:r.name,url:r.url,params:i},e.$prevState={name:a.name,url:a.url,params:o}}),e.$on("$stateChangeError",function(t,n,r,i,a,o){e.$routing=!1,console.error("Error while switching route to "+n.name),console.error(o)}),e.$on("$stateNotFound",function(t,r,i,a){t.preventDefault(),n.go("errors_missing_route",{unfoundState:r,fromState:{to:i?i.name:"",fromParams:a}}),e.$routing=!1})}]),e.provider("pipState",["$stateProvider","pipAssertProvider",function(e,t){function n(e,n){return t.isNotNull(e,"pipState.redirect: fromState cannot be null"),t.isNotNull(n,"pipState.redirect: toState cannot be null"),r[e]=n,this}var r={};this.redirect=n,this.state=e.state,this.$get=["$state","$timeout","pipAssert",function(e,t,n){function i(i,a,o,s){n.contains(a,"name","$state.redirect: state should contains name prop"),n.isObject(o,"$state.redirect: params should be an object");var l;if(s.$routing=!0,l=r[a.name],_.isFunction(l)&&(l=l(a.name,o,s),_.isNull(l)))throw s.$routing=!1,new Error("Redirected toState cannot be null");return!!l&&(t(function(){i.preventDefault(),e.transitionTo(l,o,{location:"replace"})}),!0)}return e.redirect=i,e}]}])}(),function(){"use strict";var e=angular.module("pipTimer",[]);e.service("pipTimer",["$interval","$rootScope",function(e,t){function n(){return p}function r(){p||(a=e(function(){t.$broadcast("pipAutoPullChanges")},l),o=e(function(){t.$broadcast("pipAutoUpdatePage")},u),s=e(function(){t.$broadcast("pipAutoUpdateCollection")},c),p=!0)}function i(){a&&e.cancel(a),o&&e.cancel(o),s&&e.cancel(o),p=!1}var a,o,s,l=6e4,u=15e3,c=3e5,p=!1;return{isStarted:n,start:r,stop:i}}])}(),function(){"use strict";var e=angular.module("pipTransactions",["pipTranslate","pipErrors"]);e.config(["pipTranslateProvider",function(e){e.translations("en",{ENTERING:"Entering...",PROCESSING:"Processing...",LOADING:"Loading...",SAVING:"Saving..."}),e.translations("ru",{ENTERING:"Вход в систему...",PROCESSING:"Обрабатывается...",LOADING:"Загружается...",SAVING:"Сохраняется..."})}]),e.factory("pipTransaction",["$rootScope","pipError",function(e,t){function n(t){e.transactions[t]={id:void 0,operation:void 0}}function r(r,i){r=r||"global";var a=t(r),o={error:a,reset:function(){n(),a.reset()},busy:function(){var t=e.transactions[r];return null!=t&&t.id},failed:function(){return!a.empty()},aborted:function(t){var n=e.transactions[r];return _.isNull(n)||n.id!=t},get:function(){return _.isNull(e.transactions[r])&&n(r),e.transactions[r]},id:function(){var t=e.transactions[r];return t?t.id:null},operation:function(){var t=e.transactions[r];return t?t.operation:null},errorMessage:function(){return a.message()},begin:function(t){var n=e.transactions[r];return null!=n&&n.id?null:(n=e.transactions[r]={id:(new Date).getTime(),operation:t||"PROCESSING"},a.reset(),n.id)},abort:function(){var t=e.transactions[r];t&&(t.id=null),a.reset()},end:function(t){t?a.set(t):a.reset();var n=e.transactions[r];null!=n&&(n.id=null)}};return _.isObject(i)&&(i.error=a,i.transaction=o),o}return e.transactions={},r}])}(),function(){"use strict";var e=angular.module("pipTranslate",["LocalStorageModule","pipAssert"]);e.provider("pipTranslate",["pipAssertProvider",function(e){function t(t){return e.isString(t||"","pipTranslateProvider.use or pipTranslateProvider.language: argument should be a string"),null!=t&&(f=t),f}function n(t){return null!=t&&(e.isBoolean(t||"","pipTranslateProvider.persist: argument should be a boolean"),
d=t),d}function r(t){return null!=t&&(e.isBoolean(t||"","pipTranslateProvider.setRoot: argument should be a boolean"),g=t),g}function i(t,n){e.isString(t,"pipTranslate.setTranslations or pipTranslateProvider.translations: first argument should be a string"),e.isObject(n,"pipTranslate.setTranslations or pipTranslateProvider.translations: second argument should be an object");var r=h[t]||{};h[t]=_.extend(r,n)}function a(e){if(_.isNull(e)||_.isUndefined(e))return"";var t=h[f]||{};return t[e]||e}function o(t){if(_.isNull(t)||0==t.length)return[];e.isArray(t,"pipTranslate.translateArray: argument should be an array");var n=[],r=h[f]||{};return _.each(t,function(e){var t=e||"";n.push(r[t]||t)}),n}function s(t,n,r){if(_.isNull(t)||0==t.length)return[];e.isArray(t,"pipTranslate.translateSet: first argument should be an array"),e.isString(n||"","pipTranslate.translateSet: second argument should be a string"),e.isString(r||"","pipTranslate.translateSet: third argument should be a string"),n=n||"id",r=r||"name";var i=[],a=h[f]||{};return _.each(t,function(e){var t={},o=e||"";t[n]=o,t[r]=a[o]||o,i.push(t)}),i}function l(t,n,r){if(_.isNull(t)||0==t.length)return[];e.isArray(t,"pipTranslate.translateObjects: first argument should be an array"),e.isString(n||"","pipTranslate.translateObjects: second argument should be a string"),e.isString(r||"","pipTranslate.translateObjects: third argument should be a string"),n=n||"name",r=r||"nameLocal";var i=h[f]||{};return _.each(t,function(e){var t=e,a=t[n]||"";t[r]=i[a]||a}),t}function u(t,n){if(e.isString(n||"","pipTranslate.translateById: second argument should be a string"),e.isString(t||"","pipTranslate.translateById: first argument should be a string"),t=t?t+"_":"",n=(t+n).replace(/ /g,"_").toUpperCase(),null==n)return"";var r=h[f]||{};return r[n]||n}function c(t,n,r,i){if(_.isNull(t)||0==t.length)return[];e.isArray(t,"pipTranslate.translateSetById: first argument should be an array"),e.isString(n||"","pipTranslate.translateSetById: second argument should be a string"),e.isString(r||"","pipTranslate.translateSetById: third argument should be a string"),e.isString(i||"","pipTranslate.translateSetById: forth argument should be a string"),n=n?n.replace(/ /g,"_").toUpperCase():"",r=r||"id",i=i||"name";var a=[],o=h[f]||{};return _.each(t,function(e){var t={},s=e||"";t[r]=s,t[i]=o[n+"_"+s]||s,a.push(t)}),a}function p(t,n,r,i){if(_.isNull(t)||0==t.length)return[];e.isArray(t,"pipTranslate.translateStringsSet: first argument should be an array"),e.isString(n||"","pipTranslate.translateStringsSet: second argument should be a string"),e.isString(r||"","pipTranslate.translateStringsSet: third argument should be a string"),e.isString(i||"","pipTranslate.translateStringsSet: forth argument should be a string"),r=r||"id",i=i||"name",n=n?n.replace(/ /g,"_").toUpperCase()+"_":"";var a=[],o=h[f]||{};return _.each(t,function(e){var t={},s=e||"";t[r]=s,t[i]=o[n+s.replace(/ /g,"_").toUpperCase()]||n+s.replace(/ /g,"_").toUpperCase(),a.push(t)}),a}var f="en",d=!0,g=!0,h={en:{en:"English",ru:"Russian",es:"Spanish",pt:"Portuguese",de:"German",fr:"French"},ru:{en:"Английский",ru:"Русский",es:"Испанский",pt:"Португальский",de:"Немецкий",fr:"Французский"}};this.translations=i,this.language=t,this.use=t,this.persist=n,this.setRoot=r,this.$get=["$rootScope","$timeout","localStorageService","pipAssert",function(e,t,n,r){function h(n,r){n=void 0===n||!!n,r=void 0===r||!!r,e.$reset=n,e.$partialReset=r,t(function(){e.$reset=!1,e.$partialReset=!1},0)}return d&&(f=n.get("language")||f),g&&(e.$language=f),{use:function(t,i,a){return r.isString(t||"","pipTranslate.use: argument should be a string"),null!=t&&t!=f&&(f=t,d&&n.set("language",f),g&&(e.$language=f),h(i,a)),f},translations:i,translate:a,translateArray:o,translateSet:s,translateObjects:l,translateById:u,translateSetById:c,translateStringsSet:p}}]}]),e.directive("pipTranslate",["pipTranslate",function(e){return{restrict:"EA",scope:{key1:"@pipTranslate",key2:"@key"},link:function(t,n,r){var i=t.key1||t.key2,a=e.translate(i);n.text(a)}}}]),e.directive("pipTranslateHtml",["pipTranslate",function(e){return{restrict:"EA",scope:{key1:"@pipTranslateHtml",key2:"@key"},link:function(t,n,r){var i=t.key1||t.key2,a=e.translate(i);n.html(a)}}}])}();